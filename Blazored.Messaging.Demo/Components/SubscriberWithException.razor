@inject IMessagingService MessagingService
@using Blazor.Messaging.Demo.Messages
@implements IDisposable

<h3>Notification Component with exception</h3>

<p>@notification</p>

@code {
    private string notification = "Waiting for login...";

    private void SyncHandler(UserLoggedInMessage message)
    {
        notification = $"{message.Username} has logged in!";
        throw new Exception("An error occurred in the handler");
        StateHasChanged();
    }

    protected override void OnInitialized()
    {
        MessagingService.Subscribe<UserLoggedInMessage>(SyncHandler);
    }

    public void Dispose()
    {
        MessagingService.Unsubscribe<UserLoggedInMessage>(SyncHandler);
    }
}